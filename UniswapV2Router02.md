# unisawpè·¯ç”±åˆçº¦
- åˆçº¦åˆ†3éƒ¨åˆ†,æ·»åŠ æµåŠ¨æ€§,ç§»é™¤æµåŠ¨æ€§,äº¤æ¢


|**æ–¹æ³•åç§°**|**å¯è§†èŒƒå›´**|**ç±»å‹**|**ä¿®é¥°ç¬¦**|
|:-:|:-:|:-:|:-:|
| Constructor | Public  | ğŸ›‘  ||
| Fallback | External  |  ğŸ’µ ||
| receive | External  |  ğŸ’µ ||
| _addLiquidity | Internal ğŸ”’ | ğŸ›‘  | |
| addLiquidity | External  | ğŸ›‘  | ensure |
| addLiquidityETH | External  |  ğŸ’µ | ensure |
| removeLiquidity | Public  | ğŸ›‘  | ensure |
| removeLiquidityETH | Public  | ğŸ›‘  | ensure |
| removeLiquidityWithPermit | External  | ğŸ›‘  ||
| removeLiquidityETHWithPermit | External  | ğŸ›‘  ||
| removeLiquidityETHSupportingFeeOnTransferTokens | Public  | ğŸ›‘  | ensure |
| removeLiquidityETHWithPermitSupportingFeeOnTransferTokens | External  | ğŸ›‘  ||
| _swap | Internal ğŸ”’ | ğŸ›‘  | |
| swapExactTokensForTokens | External  | ğŸ›‘  | ensure |
| swapTokensForExactTokens | External  | ğŸ›‘  | ensure |
| swapExactETHForTokens | External  |  ğŸ’µ | ensure |
| swapTokensForExactETH | External  | ğŸ›‘  | ensure |
| swapExactTokensForETH | External  | ğŸ›‘  | ensure |
| swapETHForExactTokens | External  |  ğŸ’µ | ensure |
| _swapSupportingFeeOnTransferTokens | Internal ğŸ”’ | ğŸ›‘  | |
| swapExactTokensForTokensSupportingFeeOnTransferTokens | External  | ğŸ›‘  | ensure |
| swapExactETHForTokensSupportingFeeOnTransferTokens | External  |  ğŸ’µ | ensure |
| swapExactTokensForETHSupportingFeeOnTransferTokens | External  | ğŸ›‘  | ensure |


## æ·»åŠ æµåŠ¨æ€§æ–¹æ³•
- pairåˆçº¦æ‹¥æœ‰ä¸€å¥—erc20ä»£å¸çš„æ‰€æœ‰æ–¹æ³•
- ç”¨æˆ·å‡†å¤‡TokenAå’ŒTokenBä¸¤ä¸ªä»£å¸,æœŸæœ›æ•°é‡AB,æœ€å°æ•°é‡ABå››ä¸ªæ•°å€¼åˆ›å»ºæµåŠ¨æ€§
- æ·»åŠ æµåŠ¨æ€§æ–¹æ³•æ ¹æ®æœŸæœ›ABæ•°é‡å’Œæœ€å°ABæ•°é‡ä¹˜ä»¥å‚¨å¤‡é‡æ¯”ä¾‹è®¡ç®—æœ€ä¼˜å–å‡ºæ•°é‡AB
- æµåŠ¨æ€§æ–¹æ³•æ ¹æ®å–å‡ºæ•°é‡ABå°†Tokenå­˜å…¥pairåˆçº¦
- pairåˆçº¦ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ªliquidityæµåŠ¨æ€§æ•°å€¼,ä¸ºå­˜å…¥æ•°é‡ABçš„å¹³æ–¹æ ¹
- æ·»åŠ æµåŠ¨æ€§æ–¹æ³•åˆ†ä¸ºä¸¤ç§,æ·»åŠ ä¸¤ä¸ªtokençš„æµåŠ¨æ€§å’Œæ·»åŠ tokenå’ŒETHçš„æµåŠ¨æ€§
- æ·»åŠ tokenå’ŒETHçš„æµåŠ¨æ€§æ–¹æ³•ä¼šå°†ETHå…‘æ¢æˆWETHå†è¿›è¡Œæ“ä½œ,

### _addLiquidity æ·»åŠ æµåŠ¨æ€§ç§æœ‰æ–¹æ³•
    * @dev æ·»åŠ æµåŠ¨æ€§çš„ç§æœ‰æ–¹æ³•
    * @param tokenA tokenAåœ°å€
    * @param tokenB tokenBåœ°å€
    * @param amountADesired æœŸæœ›æ•°é‡A
    * @param amountBDesired æœŸæœ›æ•°é‡B
    * @param amountAMin æœ€å°æ•°é‡A
    * @param amountBMin æœ€å°æ•°é‡B
    * @return amountA   æ•°é‡A
    * @return amountB   æ•°é‡B

1. å¦‚æœTokenAï¼ŒTokenBçš„é…å¯¹åˆçº¦ä¸å­˜åœ¨åˆ™åˆ›å»ºpair
2. ä»`pairåˆçº¦`è·å– å‚¨å¤‡é‡A, å‚¨å¤‡é‡Bï¼Œå‚¨å¤‡é‡ABç»è¿‡æ’åº
3. å¦‚æœå‚¨å¤‡reserveA, reserveB==0ï¼Œ
    - åˆ™è¿”å›å€¼(æ•°é‡A,æ•°é‡B)=æœŸæœ›å€¼(æœŸæœ›æ•°é‡A,æœŸæœ›æ•°é‡B)
    - å¦åˆ™
        1. æœ€ä¼˜æ•°é‡B = æœŸæœ›æ•°é‡A * å‚¨å¤‡é‡B / å‚¨å¤‡é‡A
        2. å¦‚æœæœ€ä¼˜æ•°é‡B <= æœŸæœ›æ•°é‡B
            - åˆ™
                1. ç¡®è®¤æœ€ä¼˜æ•°é‡B >= æœ€å°æ•°é‡B
                2. (æ•°é‡A,æ•°é‡B) = æœŸæœ›æ•°é‡A, æœ€ä¼˜æ•°é‡B
            - å¦åˆ™
                1. æœ€ä¼˜æ•°é‡A = æœŸæœ›æ•°é‡A * å‚¨å¤‡é‡A / å‚¨å¤‡é‡B
                2. æ–­è¨€æœ€ä¼˜æ•°é‡A <= æœŸæœ›æ•°é‡A
                3. ç¡®è®¤æœ€ä¼˜æ•°é‡A >= æœ€å°æ•°é‡A
                4. (æ•°é‡A,æ•°é‡B) = æœ€ä¼˜æ•°é‡A, æœŸæœ›æ•°é‡B

### addLiquidity æ·»åŠ æµåŠ¨æ€§æ–¹æ³•
     * @param token tokenåœ°å€
     * @param amountTokenDesired æœŸæœ›æ•°é‡
     * @param amountTokenMin Tokenæœ€å°æ•°é‡
     * @param amountETHMin ETHæœ€å°æ•°é‡
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amountToken   Tokenæ•°é‡
     * @return amountETH   ETHæ•°é‡
     * @return liquidity   æµåŠ¨æ€§æ•°é‡

1. (æ•°é‡A,æ•°é‡B) = _addLiquidity(tokenAåœ°å€,tokenBåœ°å€,æœŸæœ›æ•°é‡A,æœŸæœ›æ•°é‡B,æœ€å°æ•°é‡A,æœ€å°æ•°é‡B)
2. æ ¹æ®TokenA,TokenBåœ°å€,è·å–`pairåˆçº¦`åœ°å€
3. å°†æ•°é‡ä¸º`æ•°é‡A`çš„tokenAä»msg.senderè´¦æˆ·ä¸­å®‰å…¨å‘é€åˆ°`pairåˆçº¦`åœ°å€
4. å°†æ•°é‡ä¸º`æ•°é‡B`çš„tokenBä»msg.senderè´¦æˆ·ä¸­å®‰å…¨å‘é€åˆ°`pairåˆçº¦`åœ°å€
5. æµåŠ¨æ€§æ•°é‡ = pairåˆçº¦çš„é“¸é€ æ–¹æ³•é“¸é€ ç»™`toåœ°å€`çš„è¿”å›å€¼

### addLiquidityETH æ·»åŠ ETHæµåŠ¨æ€§æ–¹æ³•
     * @dev æ·»åŠ ETHæµåŠ¨æ€§æ–¹æ³•
     * @param token tokenåœ°å€
     * @param amountTokenDesired TokenæœŸæœ›æ•°é‡
     * @param amountTokenMin Tokenæœ€å°æ•°é‡
     * @param amountETHMin ETHæœ€å°æ•°é‡
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amountToken   Tokenæ•°é‡
     * @return amountETH   ETHæ•°é‡
     * @return liquidity   æµåŠ¨æ€§æ•°é‡

1. (Tokenæ•°é‡,ETHæ•°é‡) = _addLiquidity(tokenåœ°å€,WETHåœ°å€,TokenæœŸæœ›æ•°é‡,æ”¶åˆ°çš„ä¸»å¸æ•°é‡,Tokenæœ€å°æ•°é‡,ETHæœ€å°æ•°é‡)
2. æ ¹æ®Token,WETHåœ°å€,è·å–`pairåˆçº¦`åœ°å€
3. å°†`Tokenæ•°é‡`çš„tokenä»msg.senderè´¦æˆ·ä¸­å®‰å…¨å‘é€åˆ°`pairåˆçº¦`åœ°å€
4. å‘`WETHåˆçº¦`å­˜æ¬¾`ETHæ•°é‡`çš„ä¸»å¸
5. å°†`ETHæ•°é‡`çš„`WETH`tokenå‘é€åˆ°`pairåˆçº¦`åœ°å€
6. æµåŠ¨æ€§æ•°é‡ = pairåˆçº¦çš„é“¸é€ æ–¹æ³•é“¸é€ ç»™`toåœ°å€`çš„è¿”å›å€¼
7. å¦‚æœ`æ”¶åˆ°çš„ä¸»å¸æ•°é‡`>`ETHæ•°é‡` åˆ™è¿”è¿˜`æ”¶åˆ°çš„ä¸»å¸æ•°é‡`-`ETHæ•°é‡`

## ç§»é™¤æµåŠ¨æ€§æ–¹æ³•
- å°†å‘é€è´¦æˆ·çš„æµåŠ¨æ€§æ•°é‡è¿”è¿˜ç»™pairåˆçº¦
- åœ¨pairåˆçº¦ä¸­é”€æ¯æµåŠ¨æ€§æ•°é‡,ç„¶åæ ¹æ®æœ€å°æ•°é‡ABè®¡ç®—è¿”è¿˜ç»™ç”¨æˆ·çš„tokenAB
- ç§»é™¤æµåŠ¨æ€§æ–¹æ³•åˆ†ä¸¤ç§,ç§»é™¤ä¸¤ä¸ªtokençš„æµåŠ¨æ€§,å’Œç§»é™¤tokenå’ŒETHçš„æµåŠ¨æ€§
- è¿™ä¸¤ç§æ–¹æ³•åˆåˆ†åˆ«æ‹¥æœ‰ä¸¤ä¸ªå‰ç½®æ–¹æ³•,å¸¦ç­¾åç§»é™¤ä¸¤ä¸ªtokenæµåŠ¨æ€§å’Œå¸¦ç­¾åç§»é™¤tokenå’ŒETHæµåŠ¨æ€§
- é™¤æ­¤ä¹‹å¤–è¿˜æœ‰æ”¯æŒæ”¶ç¨çš„ç§»é™¤ETHæµåŠ¨æ€§æ–¹æ³•,å’Œå¸¦ç­¾åæ”¯æŒæ”¶ç¨çš„ç§»é™¤ETHæµåŠ¨æ€§æ–¹æ³•

### removeLiquidity ç§»é™¤æµåŠ¨æ€§æ–¹æ³•
     * @dev ç§»é™¤æµåŠ¨æ€§
     * @param tokenA tokenAåœ°å€
     * @param tokenB tokenBåœ°å€
     * @param liquidity æµåŠ¨æ€§æ•°é‡
     * @param amountAMin æœ€å°æ•°é‡A
     * @param amountBMin æœ€å°æ•°é‡B
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amountA   æ•°é‡A
     * @return amountB   æ•°é‡B

1. è®¡ç®—TokenA,TokenBçš„CREATE2åœ°å€ï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•å¤–éƒ¨è°ƒç”¨
2. å°†æµåŠ¨æ€§æ•°é‡ä»ç”¨æˆ·å‘é€åˆ°pairåœ°å€(éœ€æå‰æ‰¹å‡†)
3. pairåˆçº¦é”€æ¯æµåŠ¨æ€§æ•°é‡,å¹¶å°†æ•°å€¼0,1çš„tokenå‘é€åˆ°toåœ°å€
4. æ’åºtokenA,tokenB
5. æŒ‰æ’åºåçš„tokené¡ºåºè¿”å›æ•°å€¼AB
6. ç¡®ä¿æ•°å€¼ABå¤§äºæœ€å°å€¼AB

### removeLiquidityETH ç§»é™¤ETHæµåŠ¨æ€§æ–¹æ³•
     * @dev ç§»é™¤ETHæµåŠ¨æ€§
     * @param token tokenåœ°å€
     * @param liquidity æµåŠ¨æ€§æ•°é‡
     * @param amountTokenMin tokenæœ€å°æ•°é‡
     * @param amountETHMin ETHæœ€å°æ•°é‡
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amountToken   tokenæ•°é‡
     * @return amountETH   ETHæ•°é‡

1. (tokenæ•°é‡,ETHæ•°é‡) = ç§»é™¤æµåŠ¨æ€§(tokenåœ°å€,WETHåœ°å€,æµåŠ¨æ€§æ•°é‡,tokenæœ€å°æ•°é‡,ETHæœ€å°æ•°é‡,å½“å‰åˆçº¦åœ°å€,æœ€åæœŸé™)
2. å°†tokenæ•°é‡çš„tokenå‘é€åˆ°toåœ°å€
3. ä»WETHå–æ¬¾ETHæ•°é‡
4. å°†ETHæ•°é‡çš„ETHå‘é€åˆ°toåœ°å€

### removeLiquidityWithPermit å¸¦ç­¾åç§»é™¤æµåŠ¨æ€§æ–¹æ³•
     * @dev å¸¦ç­¾åç§»é™¤æµåŠ¨æ€§
     * @param tokenA tokenAåœ°å€
     * @param tokenB tokenBåœ°å€
     * @param liquidity æµåŠ¨æ€§æ•°é‡
     * @param amountAMin æœ€å°æ•°é‡A
     * @param amountBMin æœ€å°æ•°é‡B
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @param approveMax å…¨éƒ¨æ‰¹å‡†
     * @param v v
     * @param r r
     * @param s s
     * @return amountA   æ•°é‡A
     * @return amountB   æ•°é‡B

1. è®¡ç®—TokenA,TokenBçš„CREATE2åœ°å€ï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•å¤–éƒ¨è°ƒç”¨
2. å¦‚æœå…¨éƒ¨æ‰¹å‡†,valueå€¼ç­‰äºæœ€å¤§uint256,å¦åˆ™ç­‰äºæµåŠ¨æ€§
3. è°ƒç”¨pairåˆçº¦çš„è®¸å¯æ–¹æ³•(è°ƒç”¨è´¦æˆ·,å½“å‰åˆçº¦åœ°å€,æ•°å€¼,æœ€åæœŸé™,v,r,s)
4. (æ•°é‡A,æ•°é‡B) = ç§»é™¤æµåŠ¨æ€§(tokenAåœ°å€,tokenBåœ°å€,æµåŠ¨æ€§æ•°é‡,æœ€å°æ•°é‡A,æœ€å°æ•°é‡B,toåœ°å€,æœ€åæœŸé™)

### removeLiquidityETHWithPermit å¸¦ç­¾åç§»é™¤ETHæµåŠ¨æ€§æ–¹æ³•
     * @dev å¸¦ç­¾åç§»é™¤ETHæµåŠ¨æ€§
     * @param token tokenåœ°å€
     * @param liquidity æµåŠ¨æ€§æ•°é‡
     * @param amountTokenMin tokenæœ€å°æ•°é‡
     * @param amountETHMin ETHæœ€å°æ•°é‡
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @param approveMax å…¨éƒ¨æ‰¹å‡†
     * @param v v
     * @param r r
     * @param s s
     * @return amountToken   tokenæ•°é‡
     * @return amountETH   ETHæ•°é‡

1. è®¡ç®—TokenA,TokenBçš„CREATE2åœ°å€ï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•å¤–éƒ¨è°ƒç”¨
2. å¦‚æœå…¨éƒ¨æ‰¹å‡†,valueå€¼ç­‰äºæœ€å¤§uint256,å¦åˆ™ç­‰äºæµåŠ¨æ€§
3. è°ƒç”¨pairåˆçº¦çš„è®¸å¯æ–¹æ³•(è°ƒç”¨è´¦æˆ·,å½“å‰åˆçº¦åœ°å€,æ•°å€¼,æœ€åæœŸé™,v,r,s)
4. (tokenæ•°é‡,ETHæ•°é‡) = ç§»é™¤ETHæµåŠ¨æ€§(tokenåœ°å€,æµåŠ¨æ€§æ•°é‡,tokenæœ€å°æ•°é‡,ETHæœ€å°æ•°é‡,toåœ°å€,æœ€åæœŸé™)

## äº¤æ¢æ–¹æ³•
- åŸºç¡€çš„äº¤æ¢æ–¹æ³•æœ‰6ç§
    1. æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
    2. ä½¿ç”¨å°½é‡å°‘çš„tokenäº¤æ¢ç²¾ç¡®çš„token
    3. æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
    4. ä½¿ç”¨å°½é‡å°‘çš„tokenäº¤æ¢ç²¾ç¡®çš„ETH
    5. æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH
    6. ä½¿ç”¨å°½é‡å°‘çš„ETHäº¤æ¢ç²¾ç¡®çš„token
- äº¤æ¢æ–¹æ³•è°ƒç”¨æ—¶,å¯ä»¥ä¼ å…¥ä¸¤ä¸ªtokençš„äº¤æ˜“å¯¹,æˆ–è€…ä¼ å…¥å¤šä¸ªtokençš„è·¯å¾„åœ°å€æ•°ç»„
- å¤šä¸ªtokençš„è·¯å¾„åœ°å€æ•°ç»„ä¸­,æ¯å‰åä¸¤ä¸ªtokenåœ°å€å¿…é¡»æ˜¯ä¸€ä¸ªå·²ç»é…å¯¹çš„äº¤æ˜“å¯¹
- äº¤æ¢æ–¹æ³•ä¼šéå†è·¯å¾„æ•°ç»„,å°†æ¯ä¸¤ä¸ªäº¤æ˜“å¯¹æ’åºåè°ƒç”¨äº¤æ˜“å¯¹çš„pairåˆçº¦çš„äº¤æ¢æ–¹æ³•è¿›è¡Œäº¤æ˜“
- é™¤æ­¤ä¹‹å¤–äº¤æ¢æ–¹æ³•è¿˜æœ‰3ç§æ”¯æŒæ”¶ç¨çš„äº¤æ¢æ–¹æ³•
    1. æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
    2. æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
    3. æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH

### _swap ç§æœ‰äº¤æ¢æ–¹æ³•
     * @dev ç§æœ‰äº¤æ¢
     * @param amounts æ•°é¢æ•°ç»„
     * @param path è·¯å¾„
     * @param _to toåœ°å€

1. éå†`è·¯å¾„æ•°ç»„`
2. (è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€) = (å½“å‰åœ°å€,ä¸‹ä¸€ä¸ªåœ°å€)
3. token0 = æ’åº(è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€)
3. è¾“å‡ºæ•°é‡ = æ•°é¢æ•°ç»„ä¸‹ä¸€ä¸ªæ•°é¢
4. (è¾“å‡ºæ•°é¢0,è¾“å‡ºæ•°é¢1) = è¾“å…¥åœ°å€==token0 ? (0,è¾“å‡ºæ•°é¢) : (è¾“å‡ºæ•°é¢,0)
5. toåœ°å€ = i<è·¯å¾„é•¿åº¦-2 ? (è¾“å‡ºåœ°å€,è·¯å¾„ä¸‹ä¸‹ä¸ªåœ°å€)çš„pairåˆçº¦åœ°å€ : toåœ°å€
6. è°ƒç”¨(è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€)çš„`pairåˆçº¦`åœ°å€çš„`äº¤æ¢`æ–¹æ³•(è¾“å‡ºæ•°é¢0,è¾“å‡ºæ•°é¢1,toåœ°å€,0x00)

### swapExactTokensForTokens æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
     * @dev æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
     * @param amountIn ç²¾ç¡®è¾“å…¥æ•°é¢
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((ç²¾ç¡®è¾“å…¥æ•°é¢ * å‚¨å¤‡é‡Out) / (å‚¨å¤‡é‡In * 1000 + è¾“å…¥æ•°é¢))
2. ç¡®è®¤æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ >=æœ€å°æœ€å°è¾“å‡ºæ•°é¢
3. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
4. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,toåœ°å€)

### swapTokensForExactTokens ä½¿ç”¨å°½é‡å°‘çš„tokenäº¤æ¢ç²¾ç¡®çš„token
     * @dev ä½¿ç”¨å°½é‡å°‘çš„tokenäº¤æ¢ç²¾ç¡®çš„token
     * @param amountOut ç²¾ç¡®è¾“å‡ºæ•°é¢
     * @param amountInMax æœ€å¤§è¾“å…¥æ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((å‚¨å¤‡é‡In * å‚¨å¤‡é‡Out * 1000) / (å‚¨å¤‡é‡Out - è¾“å‡ºæ•°é¢ * 997) + 1)
2. ç¡®è®¤æ•°é¢æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ <=æœ€å¤§è¾“å…¥æ•°é¢
3. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
4. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,toåœ°å€)

### swapExactETHForTokens æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
     * @dev æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. ç¡®è®¤è·¯å¾„ç¬¬ä¸€ä¸ªåœ°å€ä¸ºWETH
2. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((ç²¾ç¡®è¾“å…¥æ•°é¢ * å‚¨å¤‡é‡Out) / (å‚¨å¤‡é‡In * 1000 + msg.value))
3. ç¡®è®¤æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ >=æœ€å°è¾“å‡ºæ•°é¢
4. å°†æ•°é¢æ•°ç»„[0]çš„æ•°é¢å­˜æ¬¾ETHåˆ°WETHåˆçº¦
5. æ–­è¨€å°†æ•°é¢æ•°ç»„[0]çš„æ•°é¢çš„WETHå‘é€åˆ°è·¯å¾„(0,1)çš„pairåˆçº¦åœ°å€
6. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,toåœ°å€)

### swapTokensForExactETH ä½¿ç”¨å°½é‡å°‘çš„tokenäº¤æ¢ç²¾ç¡®çš„ETH
     * @param amountOut ç²¾ç¡®è¾“å‡ºæ•°é¢
     * @param amountInMax æœ€å¤§è¾“å…¥æ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. ç¡®è®¤è·¯å¾„æœ€åä¸€ä¸ªåœ°å€ä¸ºWETH
2. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((å‚¨å¤‡é‡In * å‚¨å¤‡é‡Out * 1000) / (å‚¨å¤‡é‡Out - è¾“å‡ºæ•°é¢ * 997) + 1)
3. ç¡®è®¤æ•°é¢æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ <=æœ€å¤§è¾“å…¥æ•°é¢
4. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
5. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,toåœ°å€)
6. ä»WETHåˆçº¦ææ¬¾æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªæ•°å€¼çš„ETH
7. å°†æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªæ•°å€¼çš„ETHå‘é€åˆ°toåœ°å€

### swapExactTokensForETH æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH
     * @dev æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH
     * @param amountIn ç²¾ç¡®è¾“å…¥æ•°é¢
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. ç¡®è®¤è·¯å¾„æœ€åä¸€ä¸ªåœ°å€ä¸ºWETH
2. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((ç²¾ç¡®è¾“å…¥æ•°é¢ * å‚¨å¤‡é‡Out) / (å‚¨å¤‡é‡In * 1000 + è¾“å…¥æ•°é¢))
3. ç¡®è®¤æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ >=æœ€å°è¾“å‡ºæ•°é¢
4. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
5. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,å½“å‰åˆçº¦åœ°å€)
6. ä»WETHåˆçº¦ææ¬¾æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªæ•°å€¼çš„ETH
7. å°†æ•°é¢æ•°ç»„æœ€åä¸€ä¸ªæ•°å€¼çš„ETHå‘é€åˆ°toåœ°å€

### swapETHForExactTokens ä½¿ç”¨å°½é‡å°‘çš„ETHäº¤æ¢ç²¾ç¡®çš„token
     * @dev ä½¿ç”¨å°½é‡å°‘çš„ETHäº¤æ¢ç²¾ç¡®çš„token
     * @param amountOut ç²¾ç¡®è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     * @return amounts[]  æ•°é¢æ•°ç»„

1. ç¡®è®¤è·¯å¾„ç¬¬ä¸€ä¸ªåœ°å€ä¸ºWETH
2. æ•°é¢æ•°ç»„ â‰ˆ éå†è·¯å¾„æ•°ç»„((å‚¨å¤‡é‡In * å‚¨å¤‡é‡Out * 1000) / (å‚¨å¤‡é‡Out - è¾“å‡ºæ•°é¢ * 997) + 1)
3. ç¡®è®¤æ•°é¢æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ <=msg.value
4. å°†æ•°é¢æ•°ç»„[0]çš„æ•°é¢å­˜æ¬¾ETHåˆ°WETHåˆçº¦
5. æ–­è¨€å°†æ•°é¢æ•°ç»„[0]çš„æ•°é¢çš„WETHå‘é€åˆ°è·¯å¾„(0,1)çš„pairåˆçº¦åœ°å€
6. ç§æœ‰äº¤æ¢(æ•°é¢æ•°ç»„,è·¯å¾„æ•°ç»„,toåœ°å€)
7. å¦‚æœ`æ”¶åˆ°çš„ä¸»å¸æ•°é‡`>`æ•°é¢æ•°ç»„[0]` åˆ™è¿”è¿˜`æ”¶åˆ°çš„ä¸»å¸æ•°é‡`-`æ•°é¢æ•°ç»„[0]`

### _swapSupportingFeeOnTransferTokens æ”¯æŒæ”¶ç¨çš„ç§æœ‰äº¤æ¢
     * @dev æ”¯æŒæ”¶ç¨çš„ç§æœ‰äº¤æ¢
     * @notice è¦æ±‚åˆå§‹é‡‘é¢å·²ç»å‘é€åˆ°ç¬¬ä¸€å¯¹
     * @param path è·¯å¾„æ•°ç»„
     * @param _to toåœ°å€

1. éå†`è·¯å¾„æ•°ç»„`
2. (è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€) = (å½“å‰åœ°å€,ä¸‹ä¸€ä¸ªåœ°å€)
3. token0 = æ’åº(è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€)
4. pairåœ°å€ = (è¾“å…¥åœ°å€,è¾“å‡ºåœ°å€)
5. åˆå§‹åŒ–è¾“å…¥æ•°å€¼,è¾“å‡ºæ•°å€¼
6. è·å–å‚¨å¤‡_reserve0,_reserve1
7. æ’åº(å‚¨å¤‡é‡In,å‚¨å¤‡é‡Out)
8. è¾“å…¥æ•°é¢ = pairåœ°å€åœ¨tokenåˆçº¦çš„ä½™é¢ - å‚¨å¤‡é‡In
9. è¾“å‡ºæ•°é¢ = (è¾“å…¥æ•°é¢ * å‚¨å¤‡é‡Out) / (å‚¨å¤‡é‡In * 1000 + è¾“å…¥æ•°é¢)
10. (è¾“å‡ºæ•°é¢0,è¾“å‡ºæ•°é¢1) = è¾“å…¥åœ°å€ == token0 ? (0,è¾“å‡ºæ•°é¢0) : (è¾“å‡ºæ•°é¢0,0)
11. toåœ°å€ = å½“å‰å¾ªç¯åˆ°å€’æ•°ç¬¬äºŒ ? pairåœ°å€(è¾“å‡ºåœ°å€,è·¯å¾„æœ€åä¸€ä¸ªåœ°å€) : _toåœ°å€
12. äº¤æ¢(è¾“å‡ºæ•°é¢0,è¾“å‡ºæ•°é¢1,toåœ°å€,0x00)

### swapExactTokensForTokensSupportingFeeOnTransferTokens æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
     * @dev æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„token
     * @param amountIn ç²¾ç¡®è¾“å…¥æ•°é¢
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™
     
1. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
2. è®°å½•toåœ°å€åœ¨è·¯å¾„æ•°ç»„æœ€åä¸€ä¸ªtokenåœ°å€çš„ä½™é¢
3. æ”¯æŒæ”¶ç¨çš„ç§æœ‰äº¤æ¢(è·¯å¾„æ•°ç»„,toåœ°å€)
4. ç¡®è®¤toåœ°å€åœ¨è·¯å¾„æ•°ç»„æœ€åä¸€ä¸ªtokenåœ°å€çš„å½“å‰ä½™é¢ - ä¹‹å‰çš„ä½™é¢ >= æœ€å°è¾“å‡ºæ•°é¢

### swapExactETHForTokensSupportingFeeOnTransferTokens æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
     * @dev æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„ETHäº¤æ¢å°½é‡å¤šçš„token
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™

1. ç¡®è®¤è·¯å¾„ç¬¬ä¸€ä¸ªåœ°å€ä¸ºWETH
2. è¾“å…¥æ•°é¢ä¸ºmsg.value
3. å°†è¾“å…¥æ•°é¢å­˜æ¬¾ETHåˆ°WETHåˆçº¦
4. æ–­è¨€å°†è¾“å…¥æ•°é¢çš„WETHå‘é€åˆ°è·¯å¾„(0,1)çš„pairåˆçº¦åœ°å€
5. è®°å½•toåœ°å€åœ¨è·¯å¾„æ•°ç»„æœ€åä¸€ä¸ªtokenåœ°å€çš„ä½™é¢
6. æ”¯æŒæ”¶ç¨çš„ç§æœ‰äº¤æ¢(è·¯å¾„æ•°ç»„,toåœ°å€)
7. ç¡®è®¤toåœ°å€åœ¨è·¯å¾„æ•°ç»„æœ€åä¸€ä¸ªtokenåœ°å€çš„å½“å‰ä½™é¢ - ä¹‹å‰çš„ä½™é¢ >= æœ€å°è¾“å‡ºæ•°é¢

### swapExactTokensForETHSupportingFeeOnTransferTokens æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH
     * @dev æ”¯æŒæ”¶ç¨çš„æ ¹æ®ç²¾ç¡®çš„tokenäº¤æ¢å°½é‡å¤šçš„ETH
     * @param amountIn ç²¾ç¡®è¾“å…¥æ•°é¢
     * @param amountOutMin æœ€å°è¾“å‡ºæ•°é¢
     * @param path è·¯å¾„æ•°ç»„
     * @param to toåœ°å€
     * @param deadline æœ€åæœŸé™

1. ç¡®è®¤è·¯å¾„æœ€åä¸€ä¸ªåœ°å€ä¸ºWETH
2. å°†æ•°é‡ä¸ºæ•°é¢æ•°ç»„[0]çš„è·¯å¾„[0]çš„tokenä»è°ƒç”¨è€…è´¦æˆ·å‘é€åˆ°è·¯å¾„0,1çš„pairåˆçº¦
3. æ”¯æŒæ”¶ç¨çš„ç§æœ‰äº¤æ¢(è·¯å¾„æ•°ç»„,å½“å‰åˆçº¦åœ°å€)
4. è¾“å‡ºæ•°é¢ = å½“å‰åˆçº¦åœ°å€åœ¨WETHçš„ä½™é¢
5. ç¡®è®¤è¾“å‡ºæ•°é¢ >= æœ€å°è¾“å‡ºæ•°é¢
6. ä»WETHåˆçº¦ææ¬¾è¾“å‡ºæ•°é¢
7. å°†è¾“å‡ºæ•°é¢çš„ETHå‘é€åˆ°toåœ°å€

